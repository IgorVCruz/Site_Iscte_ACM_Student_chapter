<ui:composition template="base.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:of="http://omnifaces.org/functions"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="headContent">
		<h:outputStylesheet library="css" name="user.css" />
	</ui:define>
<div style="background-color: #fcfcfc;">
	<ui:define name="content">
	<c:if test="${param['rendered'] != null}">
		#{ userBean.setRendered(param['rendered'])}
	</c:if>

	<c:set var="user" value="#{userBean.user}" />
		<h:messages/>
        <div class="container" style="margin-bottom: 50px;margin-top:20px;">
            <div class="row">
                  <div class="col-sm-12 col-md-12 col-lg-4 col-xl-4" style="padding: 0px;">
                        <div class="card mb-3">
                            <div class="card-body text-center shadow">
                            	<h:graphicImage id="img" class="rounded-circle mb-3 mt-4" a:loading="lazy" a:alt="user_image" a:width="160" a:height="160" value="/resources/files/#{user.imagePath}"/>
                                <div class="mb-3">
                                	<h:outputLabel class="file-label btn btn-primary btn-sm" for="input-file" 	>
		                        		 <i class="fa fa-image"/> Choose image
	                        		</h:outputLabel>
                        		    
                        		    <h:form enctype="multipart/form-data" method="POST"><!-- file upload form	 -->
				                        <h:inputFile id="input-file"  class="inputfile" style="max-width: 200px;" valueChangeListener="#{userBean.changePerfilImage}">
				                        	<f:validator validatorId="ImageValidator" />
				                        	<f:ajax execute="@form" render="@form :img"/>			 
				                        </h:inputFile>
				                        <h:message for="input-file" class="error-label-sm"/>
		                           </h:form>	
                               	</div>
                                <div class="list-group">	
                                	<h:form>
		                                <h:commandLink class="list-group-item list-group-item-action" action="#{ userBean.setRendered('settings')}"><span class="text-capitalize text-muted">Settings</span></h:commandLink>
		                                <h:commandLink class="list-group-item list-group-item-action" action="#{ userBean.setRendered('events')}"> <span class="text-capitalize text-muted">Events</span></h:commandLink>
	                                    <h:commandLink class="list-group-item list-group-item-action" action="#{ userBean.setRendered('projects')}"><span class="text-capitalize text-muted">Projects</span></h:commandLink>
	                                    <h:commandLink class="list-group-item list-group-item-action" action="#{ userBean.setRendered('research')}"><span class="text-capitalize text-muted">Research</span></h:commandLink>
                                    </h:form>
                               </div>
                               <c:if test="#{user.isAdmin()}">
	                               <div class="text-center mb-3" style="margin-top:20px">
	                               		<h:link class="btn btn-primary btn-sm"  outcome="adminDashboard">Admin page</h:link>
	                               </div>
                               </c:if>
                            </div>
                        </div>
                   	</div>
                
                <div class="col-sm-12 col-md-12 col-lg-8 col-xl-8">
	
                <h:panelGroup id="definitions" >
                	<h:panelGroup rendered="#{ userBean.rendered == 'settings'}">
                		 <div class="card shadow mb-3">
                            <div class="card-header py-3">
                                <h1 class="display-4" style="font-size: 30px;">Settings</h1>
                            </div>
                            <div class="card-body">
                                <h:form id="def_form">
                                	<h:messages/>
                                    <div class="form-group">
                                    	<label for="email">
                                    		<strong>Email Address</strong>
                                    	</label>
                                    	<h:inputText class="form-control" a:type="email" a:placeholder="#{user.email}" validatorMessage="Invalid email" id="email"  a:maxlength="70" a:minlength="6" value="#{userBean.email}" a:required="false">
											<f:validateRegex pattern="(^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$)?"/>		
										</h:inputText>
										<h:message for="email" class="error-label-sm" />
                                   	</div>
                                    <div class="form-row">
                                        <div class="col">
                                            <div class="form-group">
	                                            <label for="first_name">
	                                            	<strong>First Name</strong>
	                                            </label>
	                                            <h:inputText class="form-control" a:placeholder="#{user.firstName}" validatorMessage="First name must have only letters" id="first_name" value="#{userBean.update.firstName}">
													<f:validateRegex pattern="([a-zA-Z]*)?"/>
												</h:inputText>
												<h:message for="first_name" class="error-label-sm" />
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                            	<label for="last_name">
                                            		<strong>Last Name</strong>
                                            	</label>
                                            	<h:inputText class="form-control" a:placeholder="#{user.lastName}" 
		                                            	validatorMessage="last name must have only letters" id="last_name" value="#{userBean.update.lastName}">
														<f:validateRegex pattern="([a-zA-Z]*)?"/>
												</h:inputText>
												<h:message for="last_name" class="error-label-sm" />
                                           	</div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col">
                                            <div class="form-group">
	                                            <label for="cell_phone">
	                                            	<strong>Cell Phone</strong>
	                                            </label>
                                            	<h:inputText class="form-control" a:type="tel" a:placeholder="#{user.cellPhone}"
								                 	validatorMessage="cell phone must have only 9 numbers" id="cell_phone" a:maxlength="9" a:minlength="9" value="#{userBean.update.cellPhone}">
													<f:validateRegex pattern="([0-9]{9})?"/>
												</h:inputText>
												<h:message for="cell_phone" class="error-label-sm" />
                                           	</div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                            	<label for="course">	
                                            		<strong>Course</strong>
                                           		</label>
                                           		<h:inputText class="form-control" a:placeholder="#{user.course}" id="course" value="#{userBean.update.course}"/>
                                           		<h:message for="course" class="error-label-sm" />
                                          		</div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col">
                                            <div class="form-group">
	                                            <label for="username">
	                                            	<strong>Username</strong>
	                                            </label>
	                                            <h:inputText class="form-control" a:placeholder="#{user.username}" value="#{userBean.username}"
													validatorMessage="Invalid username" id="username"  a:maxlength="60" a:minlength="6">
													<f:validateRegex pattern="(][a-zA-Z0-9]{4,})?"/>		
												</h:inputText>
												
												<h:message for="username" class="error-label-sm" />
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                            	<label for="newPassword">	
                                            		<strong>New Password</strong>
                                           		</label>
                                           		 <h:inputSecret class="form-control" a:placeholder="New password" value="#{userBean.newPassword}"
	                                            	validatorMessage="Password must be between 8 and 64 characters long" id="newPassword">
                                            		 <f:validateRegex pattern="(.{8,64})?"/>	
                                           		 </h:inputSecret>	
                                           		 <h:message for="newPassword" class="error-label-sm" />
                                          		</div>
                                        </div>
                                    </div>
                                     <div class="form-group">
                                    	<label for="about">
                                    		<strong>Description about me</strong>
                                    	</label>
                                    	<h:inputTextarea class="form-control" rows="5" a:placeholder="#{user.about}" value="#{userBean.update.about}" id="about">
                                   		</h:inputTextarea>
										<h:message for="about" class="error-label-sm" />
                                   	</div>
                                    <div class="form-group">
                                        <div class="form-row">
                                            <div class="col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                            	<h:commandButton class="btn btn-primary" value="Save Settings" actionListener="#{userBean.saveChanges}">
                                            		<f:ajax render="@form" execute="@form" />
                                            	</h:commandButton>
                                           	</div>
                                            <div class="col-9 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                                             <h:inputSecret id="password" class="form-control" a:placeholder="Password"  required="true" value="#{userBean.password}"
		                                            	requiredMessage="Password is required to save changes"/>
                                           	 <h:message for="password" class="error-label-sm" />
                                            </div>
                                        </div>
                                    </div>
                                </h:form>
                            </div>
                        </div>
	               		
	               		<div class="card shadow mb-3">
                            <div class="card-header py-3">
                                <h1 class="display-4" style="font-size: 30px;">Want to be more?</h1>
                            </div>
                            <div class="card-body text-left">
                                <div class="marginTop10">
                                    <p>If you have passion for technology and would like to find others with the same love ACM is the right place for you. We are a group of people that love to learn and create new things that will put a smile on people.</p><button class="btn btn-primary" type="button">Become an Acm member</button></div>
                                <div class="marginTop10">
                                    <p>If you are a teacher that has a research and have the need or possibility to increase your team, here you can share your research and find what you need. We are sure that here you will find what you are looking for.</p><button class="btn btn-primary"
                                        type="button">Become an investigator</button></div>
                            </div>
                        </div>
	               
	               	</h:panelGroup>
               	</h:panelGroup>

               	<h:panelGroup id="events" >
         			<h:panelGroup rendered="#{ userBean.rendered == 'events'}">
       					   <div class="card shadow mb-3">
					              <div class="card-header py-3">
					                  <h1 class="display-4" style="font-size: 30px;">My joined Events</h1>
					              </div>
					              <div class="card-body text-left">
						              <h:panelGroup class="table-responsive" rendered="#{not empty user.joinedEvents}">
				                        	<h:dataTable class="table table-hover " value="#{user.joinedEvents}" var="e" >
				                        		<h:column>
				                        			<f:facet name="header" style="text-center">
				                        				<div style="text-align:center">
				                        					Event title
				                        				</div>		
		                        					</f:facet>
													<div style="text-align:center">
			                        					<h:link class="text-dark text-center" a:data-toggle="modal" a:data-target="#event-modal#{e.id}" value="#{e.title}"/>
				                        			</div>	
				                        			<div class="modal fade" role="dialog" tabindex="-1" id="event-modal#{e.id}">
												        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
												            <div class="modal-content">
												                <div class="modal-header">
												                <h4 class="display-4 modal-title">#{e.title}</h4>
												                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
												                <div class="modal-body">
												                    <h4>Description</h4>
												                    <p><br/>#{e.description}<br/><br/></p>
												                    <h4>Requirements</h4>
												                    <p><br/>#{e.requirements}<br/><br/></p>
												                    <h4>Dates</h4>
												                    <br/>
												                    <p>TODO</p>
												                    <div class="text-center">
											                    	    <h:form>
													                        <h:button class="btn btn-primary" value="Discover" outcome="event">
													                        	<f:param name="eventId" value="#{e.id}" />
													                        </h:button>
												                        </h:form>
												                        <br/>
												                	</div>
												                	<div class="modal-footer">
												                		<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
											                		</div>
										                		</div>
												            </div>
												        </div>
												    </div>
												    
			                        			</h:column>
				                        		<h:column style="text-center">
				                        			<f:facet name="header">Edit</f:facet>
				                        			<i class="fa fa-remove"/>
				                        		</h:column>
				                        	</h:dataTable>
			                         </h:panelGroup>
		                         	<c:if test="#{empty user.joinedEvents}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;margin-bottom:20px">You don't have any events joined, try to create or discover one!!!<br/></h2>
		                      			<div class="row text-center" style="margin: 30px; auto">
			                      			<c:if test="#{user.isMember() or user.isAdmin()}">
										        <div class="col">
										    		<h:link class="btn btn-primary" outcome="createEvent"> <i class="fa fa-plus"></i> Create Events</h:link>
									    		</div>
									    	</c:if>
										    <div class="col">
										    	<h:link class="btn btn-primary"  outcome="events"><i class="fa fa-search"></i> Discover Events</h:link>
										    </div>
										</div>
		                      		</c:if>
					              </div>
					          </div>
					          
				          	  <div class="card shadow mb-3">
			                     <div class="card-header py-3">
			                         <h1 class="display-4" style="font-size: 30px;">My liked events</h1>
			                     </div>
			                     <div class="card-body text-left">
			                     	<h:panelGroup id="event-likes-table" class="table-responsive" rendered="#{not empty user.likedEvents}">
			                        
			                        	<h:dataTable class="table table-hover" value="#{user.likedEvents}" var="e" >
			                        		<h:column>
		                        				<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Event title
	                        						</div>
	                        					</f:facet>
												<div style="text-align:center">
			                        				<h:link class="text-dark" a:data-toggle="modal" a:data-target="#event-like-modal" value="#{e.title}"/>
												</div>

			                        			<div class="modal fade" role="dialog" tabindex="-1" id="event-like-modal">
											        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
											            <div class="modal-content">
											                <div class="modal-header">
											                <h4 class="display-4 modal-title">#{e.title}</h4>
											                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
											                <div class="modal-body">
											                    <h4>Description</h4>
											                    <p><br/>#{e.description}<br/><br/></p>
											                    <h4>Requirements</h4>
											                    <p><br/>#{e.requirements}<br/><br/></p>
											                    <h4>Dates</h4>
											                    <br/>
											                    <p>TODO</p>
											                    <div class="text-center">
										                    	    <h:form>
												                        <h:button class="btn btn-primary" value="Discover" outcome="event">
												                        	<f:param name="eventId" value="#{e.id}" />
												                        </h:button>
											                        </h:form>
											                        <br/>
											                	</div>
											                	<div class="modal-footer">
											                		<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
										                		</div>
									                		</div>
											            </div>
											        </div>
											    </div>
		                        			</h:column>
			                        		<h:column >
			                        			<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Unlike
	                        						</div>
	                        					</f:facet>
			                        			<div style="text-align:center">
			                        				<h:form>
			                        					<h:commandLink  >
			                        						<f:attribute name="eventId" value="#{e.id}"/>
			                        						<f:ajax render="@all" execute="@this"/>
			                        						<i class="fa fa-thumbs-down hover-red"/>
			                        					</h:commandLink>
			                        				</h:form>
			                        			</div>
			                        		</h:column>
			                        	</h:dataTable>
			                        </h:panelGroup>
									<c:if test="#{empty user.likedEvents}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">You didn't liked any project <i class="fa fa-frown-o"/></h2>
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">Try to discover one!!!<br/></h2>
	                      		
	                      				<div style="text-align:center;margin-top:40px">
	                      					<h:link class="btn btn-primary"  outcome="projects"><i class="fa fa-search"></i> Discover Projects</h:link>
	                      				</div>
									</c:if>
			                     </div>
			                 </div>
               		</h:panelGroup>
               	</h:panelGroup>

      	     	<h:panelGroup id="projects" >
         			<h:panelGroup rendered="#{ userBean.rendered == 'projects'}">
						   <div class="card shadow mb-3">
					              <div class="card-header py-3">
					                  <h1 class="display-4" style="font-size: 30px;">My joined projects</h1>
					              </div>
					              <div class="card-body text-left">
						              <h:panelGroup class="table-responsive" rendered="#{not empty user.joinedProjects}">
				                        	<h:dataTable class="table table-hover" value="#{user.joinedProjects}" var="p" >
				                        		<h:column>
				                        			<f:facet name="header">Project title</f:facet>

				                        			<h:link class="text-dark" a:data-toggle="modal" a:data-target="#project-modal#{p.id}" value="#{p.title}"/>
				                        			
				                        			<div class="modal fade text-center" role="dialog" tabindex="-1" id="project-modal#{p.id}">
												        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
												            <div class="modal-content">
												                <div class="modal-header">
												                <h4 class="display-4 modal-title">#{p.title}</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
												                <div class="modal-body">
												                    <h4>Description</h4>
												                    <p><br/>#{p.description}<br/><br/></p>
												                    <h4>Requirements</h4>
												                    <p><br/>#{p.requirements}<br/><br/></p>
												                    <h4>Dates</h4>
												                    <br/>
												                    <p>Dead line : #{p.deadline.toString().substring(0,16)}</p>
												                    <p>Candidature dead line : #{p.subscriptionDeadline.toString().substring(0,16)}</p>
												                    <div class="text-center">
											                    	    <h:form>
													                        <h:button class="btn btn-primary" value="Discover" outcome="project">
													                        	<f:param name="projectID" value="#{p.id}" />
													                        </h:button>
												                        </h:form>
												                        <br/>
												                	</div>
												                	<div class="modal-footer">
												                		<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
												                		<!-- <button class="btn btn-primary" type="button">Save</button> -->
											                		</div>
										                		</div>
												            </div>
												        </div>
												    </div>
												    
			                        			</h:column>
				                        		<h:column>
				                        			<f:facet name="header">Date</f:facet>
				                        			#{p.deadline.toString().substring(0,16)}
			                        			</h:column>
				                        		<h:column >
				                        			<f:facet name="header">Edit</f:facet>
				                        			<h:link class="text-dark" a:data-toggle="modal" a:data-target="#remove-project-modal">
				                        				<i class="fa fa-remove"/>	
				                        			</h:link>	
				                        			<h:panelGroup rendered="#{p.manager.id == sessionScope.user.id}">
			                        					<h:link class="text-dark" style="max-width:20px"> <i class="fa fa-eye"/> </h:link>
			                        				</h:panelGroup>
	                        				    	
	                        				    	<div id="remove-project-modal" class="modal fade" role="dialog" tabindex="-1">
												        <div class="modal-dialog" role="document">
												            <div class="modal-content text-center">
												                <div class="modal-header">
												                    <h4 class="modal-title">Are you sure?</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
												                <div class="modal-body">
												                    <p>This operation will remove you from this project, if you want to join again you will need to submit the candidature again.
												                    <br></br>
												                    If you are the manager you won't be able to leave the project unless you assign a new project manager or delete the project.</p>
												                </div>
												                <div class="modal-footer">
													                <button class="btn btn-light" type="button" data-dismiss="modal">Cancel</button>
													                <h:form>
							                        					<h:commandLink class="btn btn-primary" data-dismiss="modal" actionListener="#{userBean.removeProject}">
							                        						<f:attribute name="projectId" value="#{p.id}"/>
							                        						<f:ajax render="@all" execute="@this"/>
							                        						Remove
							                        					</h:commandLink>
						                        					</h:form>
													            </div>
													        </div>
													    </div>
												    </div>
				                        		</h:column>
				                        	</h:dataTable>
			                         </h:panelGroup>
		                         	<c:if test="#{empty user.joinedProjects}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;margin-bottom:20px">You don't have any projects joined, try to create or discover one!!!<br/></h2>
		                      		</c:if>
	                      			<div class="row text-center" style="margin: 0px; auto">
									    <div class="col">
									    	<c:if test="#{user.isMember() or user.isAdmin()}">
									    		<h:link class="btn btn-primary" outcome="createProject"> <i class="fa fa-plus"></i> Create Project</h:link>
									    	</c:if>
									    	<c:if test="#{not (user.isMember() or user.isAdmin())}">
									    		<a data-target="#error-modal" data-toggle="modal" class="btn btn-primary" style="color:white"><i class="fa fa-plus"></i> Create Research</a>
								    		     <div role="dialog" tabindex="-1" class="modal fade" id="error-modal">
												    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
												        <div class="modal-content">
												            <div class="modal-body text-center">
												                <h1 class="display-4" style="font-size: 40px;color: rgb(47,47,47);"><i class="fa fa-frown-o"></i> Sorry, you need to be an ACM member to be able to create a project</h1>
											                	<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
										                	</div>
												        </div>
												    </div>
												</div>
									    	</c:if>
								    	</div>
									    <div class="col">
									    	<h:link class="btn btn-primary"  outcome="projects"><i class="fa fa-search"></i> Discover Projects</h:link>
									    </div>
									</div>
					              </div>
					          </div>

						   <div class="card shadow mb-3">
			                     <div class="card-header py-3">
			                         <h1 class="display-4" style="font-size: 30px;">My liked projects</h1>
			                     </div>
			                     <div class="card-body text-left">
			                     	<h:panelGroup id="likes-table" class="table-responsive" rendered="#{not empty user.likedProjects}">
			                        
			                        	<h:dataTable class="table table-hover" value="#{user.likedProjects}" var="p" >
			                        		<h:column>
		                        				<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Project title
	                        						</div>
	                        					</f:facet>
												<div style="text-align:center">
			                        				<h:link class="text-dark" a:data-toggle="modal" a:data-target="#project-modal#{p.id}" value="#{p.title}"/>
												</div>

			                        			<div class="modal fade text-center" role="dialog" tabindex="-1" id="project-modal#{p.id}" >
											        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
											            <div class="modal-content">
											                <div class="modal-header">
											                <h4 class="display-4 modal-title">#{p.title}</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
											                <div class="modal-body">
											                    <h4>Description</h4>
											                    <p><br/>#{p.description}<br/><br/></p>
											                    <h4>Requirements</h4>
											                    <p><br/>#{p.requirements}<br/><br/></p>
											                    <h4>Dates</h4>
											                    <br/>
											                    <p>Dead line : #{p.deadline.toString().substring(0,16)}</p>
											                    <p>Candidature dead line : #{p.subscriptionDeadline.toString().substring(0,16)}</p>
											                    <div>
										                    	    <h:form>
												                        <h:button class="btn btn-primary" value="Discover" outcome="project">
												                        	<f:param name="projectID" value="#{p.id}" />
												                        </h:button>
											                        </h:form>
											                        <br/>
											                	</div>
											                	<div class="modal-footer">
											                		<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
											                		<!-- <button class="btn btn-primary" type="button">Save</button> -->
										                		</div>
									                		</div>
											            </div>
											        </div>
											    </div>
		                        			</h:column>
			                        		<h:column>
			                        			<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Date
	                        						</div>
	                        					</f:facet>
	                        					<div style="text-align:center">
			                        				#{p.deadline.toString().substring(0,16)}
			                        			</div>
		                        			</h:column>
			                        		<h:column >
			                        			<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Unlike
	                        						</div>
	                        					</f:facet>
			                        			<div style="text-align:center">
			                        				<h:form>
			                        					<h:commandLink  actionListener="#{userBean.dislikeProject}">
			                        						<f:attribute name="projectId" value="#{p.id}"/>
			                        						<f:ajax render="@all" execute="@this"/>
			                        						<i class="fa fa-thumbs-down hover-red"/>
			                        					</h:commandLink>
			                        				</h:form>
			                        			</div>
			                        		</h:column>
			                        	</h:dataTable>
			                        </h:panelGroup>

									<c:if test="#{empty user.likedProjects}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">You didn't liked any project <i class="fa fa-frown-o"/></h2>
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">Try to discover one!!!<br/></h2>
	                      		
	                      				<div style="text-align:center;margin-top:40px">
	                      					<h:link class="btn btn-primary"  outcome="projects"><i class="fa fa-search"></i> Discover Projects</h:link>
	                      				</div>
									</c:if>
			                     </div>
			                 </div>
			                 
			                 <div class="card shadow mb-3">
					              <div class="card-header py-3">
					                  <h1 class="display-4" style="font-size: 30px;">My project candidatures</h1>
					              </div>
					              <div class="card-body text-left">
						              <h:panelGroup id="candidatures-project" class="table-responsive" rendered="#{not empty user.projectsCandidatures}">
				                        	<h:dataTable class="table table-hover" value="#{user.projectsCandidatures}" var="c" >
				                        		<h:column>
			                        				<f:facet name="header">
				                        				<div style="text-align:center">
				                        					Motivation
		                        						</div>
		                        					</f:facet>
		                        					<div style="text-align:center">
		                        						#{c.motivation.substring(0,c.motivation.length() > 16 ? 16 : c.motivation.length())}
		                        						#{c.motivation.length() > 16 ? "..." : ""}
	                        						</div>
			                        			</h:column>
				                        		<h:column>
				                        			<f:facet name="header">
				                        				<div style="text-align:center">
				                        					Hablitation
		                        						</div>
		                        					</f:facet>
		                        					<div style="text-align:center">
		                        						#{c.hablitations.substring(0,c.motivation.length() > 16 ? 16 : c.motivation.length())}
		                        						#{c.hablitations.length() > 16 ? "..." : ""}
		                        					</div>
	                       						</h:column>
	                   							<h:column>
				                        			<f:facet name="header">
				                        				<div style="text-align:center">
				                        					Date
		                        						</div>
		                        						
		                        					</f:facet>
		                        					<div style="text-align:center">
			                        					#{c.date.toString().substring(0,16)}
	                        						</div>
	                       						</h:column>
	                       						<h:column >
				                        			<div style="text-align:center;">
			                        					<h:link >
			                        						<i class="fa fa-pencil" style="color: rgba(33,37,41,0.85);"/>
			                        					</h:link>
				                        			</div>
				                        		</h:column>
				                        	</h:dataTable>
				                        </h:panelGroup>
	
										<c:if test="#{empty user.projectsCandidatures}">
			                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">You didn't apply for any project</h2>
			                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">Try to discover one!!!<br/></h2>
		                      		
		                      				<div style="text-align:center;margin-top:40px">
		                      					<h:link class="btn btn-primary"  outcome="researches"><i class="fa fa-search"></i> Discover Ptojects</h:link>
		                      				</div>
										</c:if>
					              </div>
				              </div>
               		</h:panelGroup>
               	</h:panelGroup>

      	     	<h:panelGroup id="research" >
         			<h:panelGroup rendered="#{ userBean.rendered == 'research'}">
         					<div class="card shadow mb-3">
			                     <div class="card-header py-3">
			                         <h1 class="display-4" style="font-size: 30px;">My joined researches</h1>
			                     </div>
			                     <div class="card-body text-left">
			                     	<div class="card-body text-left">
						              <h:panelGroup class="table-responsive" rendered="#{not empty user.joinedResearches}">
				                        	<h:dataTable class="table table-hover" value="#{user.joinedResearches}" var="r" >
				                        		<h:column>
				                        			<f:facet name="header">Research title</f:facet>
				                        			<h:link class="text-dark" a:data-toggle="modal" a:data-target="#joined-r-modal#{r.id}" value="#{r.title}"/>
				                        			<div class="modal fade text-center" role="dialog" tabindex="-1" id="joined-r-modal#{r.id}">
												        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
												            <div class="modal-content">
												                <div class="modal-header">
												                <h4 class="display-4 modal-title">#{r.title}</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
												                <div class="modal-body">
												                    <h4>Description</h4>
												                    <p><br/>#{r.description}<br/><br/></p>
												                    <h4>Requirements</h4>
												                    <p><br/>#{r.requirements}<br/><br/></p>
												                    <div class="text-center">
											                    	    <h:form>
													                        <h:button class="btn btn-primary" value="Discover" outcome="research">
													                        	<f:param name="researchID" value="#{r.id}" />
													                        </h:button>
												                        </h:form>
												                        <br/>
												                	</div>
												                	<div class="modal-footer">
												                		<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
											                		</div>
										                		</div>
												            </div>
												        </div>
												    </div>
												    
			                        			</h:column>
				                        		<h:column>
				                        			<f:facet name="header">State</f:facet>
				                        			#{r.state}
			                        			</h:column>
				                        		<h:column>
				                        			<f:facet name="header">Edit</f:facet>
				                        			<h:link class="text-dark" a:data-toggle="modal" a:data-target="#remove-research-modal">
				                        				<i class="fa fa-remove"/>	
				                        			</h:link>	
				                        			<h:panelGroup rendered="#{r.isInvestigator(sessionScope.user.id)}">
			                        					<h:link class="text-dark" style="max-width:20px"> <i class="fa fa-eye"/></h:link>
			                        				</h:panelGroup>
		                        				    <div id="remove-research-modal" class="modal fade" role="dialog" tabindex="-1">
												        <div class="modal-dialog" role="document">
												            <div class="modal-content text-center">
												                <div class="modal-header">
												                    <h4 class="modal-title">Are you sure?</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
												                <div class="modal-body">
												                    <p>This operation will remove you from this research, if you want to join again you will have to submit the candidature again.
												                    <br></br>
												                    If you are the manager you won't be able to leave the project unless you assign a new research manager or delete the research.</p>
												                </div>
												                <div class="modal-footer">
													                <button class="btn btn-light" type="button" data-dismiss="modal">Cancel</button>
													                <h:form>
							                        					<h:commandLink class="btn btn-primary" data-dismiss="modal" actionListener="#{userBean.removeResearch}">
							                        						<f:attribute name="researchId" value="#{r.id}"/>
							                        						<f:ajax render="@all" execute="@this"/>
							                        						Remove
							                        					</h:commandLink>
						                        					</h:form>
													            </div>
													        </div>
													    </div>
												    </div>
				                        		</h:column>
				                        	</h:dataTable>
			                         </h:panelGroup>
		                         	<c:if test="#{empty user.joinedResearches}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;margin-bottom:20px">You don't have any research joined, try to create or discover one!!!<br/></h2>
		                      		</c:if>
		                      		<div class="row text-center" style="margin: 0px; auto">
									    <div class="col">
									    	<c:if test="#{user.isInvestigator() or user.isAdmin()}">
									    		<h:link class="btn btn-primary" outcome="createResearch"> <i class="fa fa-plus"></i> Create Research</h:link>
									    	</c:if>
									    	<c:if test="#{not (user.isInvestigator() or user.isAdmin())}">
									    		<a data-target="#error-modal" data-toggle="modal" class="btn btn-primary" style="color:white"><i class="fa fa-plus"></i> Create Research</a>
								    		     <div role="dialog" tabindex="-1" class="modal fade" id="error-modal">
												    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
												        <div class="modal-content">
												            <div class="modal-body text-center">
												                <h1 class="display-4" style="font-size: 40px;color: rgb(47,47,47);"><i class="fa fa-frown-o"></i> Sorry, you need to be an investigator to be able to create a research</h1>
											                	<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
										                	</div>
												        </div>
												    </div>
												</div>
									    	</c:if>
								    	</div>
									    <div class="col">
									    	<h:link class="btn btn-primary"  outcome="researches"><i class="fa fa-search"></i> Discover Researches</h:link>
									    </div>
									</div>
					              </div>
			                     </div>
			                 </div>
			                 <div class="card shadow mb-3">
			                     <div class="card-header py-3">
			                         <h1 class="display-4" style="font-size: 30px;">My liked researches</h1>
			                     </div>
			                     <div class="card-body text-left">
			                     	<h:panelGroup id="likes-table-research" class="table-responsive" rendered="#{not empty user.likedResearches}">
			                        	<h:dataTable class="table table-hover" value="#{user.likedResearches}" var="r" >
			                        		<h:column>
		                        				<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Research title
	                        						</div>
	                        					</f:facet>
												<div style="text-align:center">
			                        				<h:link class="text-dark" a:data-toggle="modal" a:data-target="#r-modal#{r.id}" value="#{r.title}"/>
												</div>

			                        			<div class="modal fade text-center" role="dialog" tabindex="-1" id="r-modal#{r.id}">
											        <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
											            <div class="modal-content ">
											                <div class="modal-header text-center">
											                <h4 class="display-4 modal-title">#{r.title}</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>
											                <div class="modal-body ">
											                    <h4>Description</h4>
											                    <p><br/>#{r.description}<br/><br/></p>
											                    <h4>Requirements</h4>
											                    <p><br/>#{r.requirements}<br/><br/></p>
											                    <div class="text-center">
										                    	    <h:form>
												                        <h:button class="btn btn-primary" value="Discover" outcome="research">
												                        	<f:param name="researchID" value="#{r.id}" />
												                        </h:button>
											                        </h:form>
											                        <br/>
											                	</div>
											                	<div class="modal-footer">
											                		<button class="btn btn-light" type="button" data-dismiss="modal">Close</button>
										                		</div>
									                		</div>
											            </div>
											        </div>
											    </div>
		                        			</h:column>
			                        		<h:column >
			                        			<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Unlike
	                        						</div>
	                        					</f:facet>
			                        			<div style="text-align:center">
			                        				<h:form>
			                        					<h:commandLink  actionListener="#{userBean.dislikeResearch}">
			                        						<f:attribute name="researchId" value="#{r.id}"/>
			                        						<f:ajax render="@all" execute="@this"/>
			                        						<i class="fa fa-thumbs-down hover-red"/>
			                        					</h:commandLink>
			                        				</h:form>
			                        			</div>
			                        		</h:column>
			                        	</h:dataTable>
			                        </h:panelGroup>
									<c:if test="#{empty user.likedResearches}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">You didn't liked any Research <i class="fa fa-frown-o"/></h2>
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">Try to discover one!!!<br/></h2>
	                      		
	                      				<div style="text-align:center;margin-top:40px">
	                      					<h:link class="btn btn-primary"  outcome="researches"><i class="fa fa-search"></i> Discover Research</h:link>
	                      				</div>
									</c:if>
			                     </div>
			                 </div>
			                 <div class="card shadow mb-3">
			                     <div class="card-header py-3">
			                         <h1 class="display-4" style="font-size: 30px;">My researches candidatures</h1>
			                     </div>
			                     <div class="card-body text-left">
			                     	<h:panelGroup id="candidatures-research" class="table-responsive" rendered="#{not empty user.researchesCandidatures}">
			                        	<h:dataTable class="table table-hover" value="#{user.researchesCandidatures}" var="c" >
			                        		<h:column>
		                        				<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Motivation
	                        						</div>
	                        					</f:facet>
	                        					<div style="text-align:center">
	                        						#{c.motivation.substring(0,c.motivation.length() > 16 ? 16 : c.motivation.length())}
	                        						#{c.motivation.length() > 16 ? "..." : ""}
                        						</div>
		                        			</h:column>
			                        		<h:column>
			                        			<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Hablitation
	                        						</div>
	                        					</f:facet>
	                        					<div style="text-align:center">
	                        						#{c.hablitations.substring(0,c.motivation.length() > 16 ? 16 : c.motivation.length())}
	                        						#{c.hablitations.length() > 16 ? "..." : ""}
	                        					</div>
                       						</h:column>
                   							<h:column>
			                        			<f:facet name="header">
			                        				<div style="text-align:center">
			                        					Date
	                        						</div>
	                        						
	                        					</f:facet>
	                        					<div style="text-align:center">
		                        					#{c.date.toString().substring(0,16)}
                        						</div>
                       						</h:column>
                       						<h:column >
			                        			<div style="text-align:center;color: rgba(33,37,41,0.85);">
		                        					<h:link>
		                        						<i class="fa fa-pencil"/>
		                        					</h:link>
			                        			</div>
			                        		</h:column>
			                        	</h:dataTable>
			                        </h:panelGroup>

									<c:if test="#{empty user.researchesCandidatures}">
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">You didn't apply for any research</h2>
		                      			<h2 class="display-4" style="font-size: 30px;text-align: center;">Try to discover one!!!<br/></h2>
	                      		
	                      				<div style="text-align:center;margin-top:40px">
	                      					<h:link class="btn btn-primary"  outcome="researches"><i class="fa fa-search"></i> Discover Research</h:link>
	                      				</div>
									</c:if>
			                     </div>
			                 </div>
	               		</h:panelGroup>
	               	</h:panelGroup>

                </div>
            </div>
        </div>
	</ui:define>
 </div>
</ui:composition>
